## 非羁押管理平台
**介绍**：这个项目是一个市级的试点应用项目。具体来说就是结合了大数据将非羁押人员的管理放到了线上，这个项目的展示层主要是一个移动小程序端和一个后台管理web端。小程序端采用的是类似健康码的模式来区别非羁押人员的一个受监管状态，非羁押人员通过小程序可以进行实时打卡，上传材料，接受公安传讯等功能，可以将当前信息及时同步给监管方。而监管方也可以在这个平台通过非羁押人员反馈到的的实时信息来对其进行一个评估和预警。此外也能够将案件申报审批，移送给检察院级。因为底层用到的是自家公司的区块链技术，所以可以保障这些信息能够安全同步给三方。而web端主要就是来统一管理三方上传交互得到的数据。我主要负责的内容是一部分小程序页面的开发和大部分后台管理的开发。
**负责内容**：后台管理系统的搭建，参与了部分小程序模块功能的实现
1. 权限系统与管理
*为什么要进行权限控制？*
虽然对于权限管理真正把关的是后端，但是如果前端不做权限控制，很多受限功能会被展示出来但是却又拒绝被访问，对于用户来说体验是不够好的。所以最好的优化方式是直接按照权限数据关闭那些对应功能的入口。此外，仍旧是对网站提供一些弱防护的。

*思路方向*
前端做的权限控制大致是先接收后端发送的权限数据，然后将这个数据注入到应用中的模式，从而对页面的展示内容和导航逻辑进行控制。
登录权限，页面权限，内容权限

*登录权限控制*
登录权限控制要做的事情,是实现哪些页面能被游客访问,哪些页面只有登录后才能被访问。因为Vue做的比较多，所以以此为例。直接的方式是利用路由配置和前置路由守卫，在需要登录访问的路由树下配置一个需要登录的属性，当用户即将跳转这些需要登录的页面时会调用路由守卫判断当前用户的登录状态（vuex存放等），登录就放行，没有登录就走定向到登录页面。

*页面权限控制*
页面权限控制与路由权限直接关联。正常的做法是后端提前根据角色配置好该角色的路由权限列表。前端则配置静态路由和动态路由，静态路由就是不区分角色性质的部分，动态路由就是区分角色的部分。
用户登录后调用权限接口获取到权限列表并存储到storage（vuex，localStorage）中，根据这个列表从动态路由中过滤不允许访问的路由，然后添加到路由栈中（router.addRoute）
*由于vue-router 4废除了之前的router.addRoutes,换成了router.addRoute.每一次只能一个个添加路由信息,所以要将allow_routes遍历循环添加.*

注意：切换用户的时候，需要强制刷新页面或者清空路由实例中的路由栈。

！！！还有一种更简单的方式是动态导航的方式，在渲染导航栏的时候，路由数据是根据调取后端返回的数据来渲染的，就能够直接显示对应角色的导航。

*内容权限控制*
页面权限控制它能做到让不同角色访问不同的页面,但对于一些颗粒度更小的项目,比如希望不同的角色都能进入页面,但要求看到的页面内容不一样,这就需要对内容进行权限控制了.
例子：在一个页面中，管理员可以增删查改，普通用户只能查
一种做法是，让后端在用户信息里增添一个权限编码字段。然后前端全局自定义一个快捷指令（vue），在区分角色类型的内容元素中，就可以通过对应需要的权限编码来判断是否有操作的权限。有权限的就在元素dom渲染上，没有则移除。
``` javascript
// 自定义全局指令
import router from './router';
import store from './store';

const app = createApp(App); //创建vue的根实例

app.directive('permission', {
  mounted(el, binding, vnode) {
    const permission = binding.value; // 获取权限值
    const page_name = router.currentRoute.value.name; // 获取当前路由名称
    const have_permissions = store.state.permission_list[page_name] || ''; // 当前用户拥有的权限
    if (!have_permissions.includes(permission)) {
      el.parentElement.removeChild(el); //不拥有该权限移除dom元素
    }
  },
});
```
2. 滑块验证
[滑块验证讲解](https://blog.csdn.net/KlausLily/article/details/120465558)

3. 二维码生成
用到的是qrcode的一个插件。然后进行了简单的封装

---
## 某市文化活动便民服务应用
**介绍**这个项目是帮一个市的宣传部做的一个移动端内嵌h5应用。项目旨在为市民提供一个快捷方便的移动平台开展社区文化活动。具体来说，就是管理员可以在平台上发布活动的具体内容。然后市民可以在这个应用上查看近期有哪些活动，该市的社区服务和活动场馆，也提供了导航功能。市民也可以在平台提出自己想要街道或者政府举办什么活动的建议，投票之类的功能。然后为了展示文化活动开展的效果，还做了一个独立的数据大屏页面展示一些重要活动指数。
**负责内容**：小程序应用的整体搭建和数据大屏的开发展示
1. `地图导航`：这个功能是借助高德地图提供的api实现的，需要提前配置小程序问直接口权限。当时遇到最大的问题是，在写附近搜索输入提示功能的时候按照官方文档的一种写法需要在地图组件配置中绑定一个input标签，但是无效，我推测情况是uniapp使用的input非原生html标签，所以导致的失效，虽然到最后我也没有解决这个问题。。。于是我只好自己封装了一个搜索组件，直接请求高德地图给的url拿到数据并显示。
2. `怎么做的大屏自适应`
一般是有几点需要考虑的。
  - 从布局的稳定性来说，尽量采用flex布局，结合元素使用百分比进行定位。
  - 然后从长度单位来说，为了保证字体或者元素长宽能够随屏幕宽高变化，可以采用视口宽度vw和视口高度vh单位。虽然对于元素长宽来说这种方式有点类似于百分比，但是它可以用于定义字体大小。我不太喜欢在数据大屏上使用rem，因为rem虽然是动态计算的。但是rem要么是根据视高，要么是根据视宽计算的，所以在不同高宽比的屏幕效果是有比较大差异的。而且使用rem相对于vh是更加耗时的，多了一次运算转换。
  - 但是vh对于浏览器最小字体是不支持的，所以在此基础上采用了另一种方法是用transform:scale做了一个resize的盒子。
  - 引入一个resize事件监听当前的视口高宽，当前高宽发生改变时，就会调用方法得到当前与初始情况的的变化比值，通过scale对页面做整体的缩放。
  - 需要注意的细节的话就是要注意防抖，页面销毁时记得移除监听事件。
  - 阿里有个dataV组件库其实封装了一个全屏容器，默认会将页面在全屏幕充满。在静态页面是这个容器是好使的，但是这个逐渐不支持屏幕缩放，在引入百度地图和高德地图的应用场景时，它会导致不能进行地图的放大和缩小。
  - 所以大屏自适应是一个综合考虑的问题。没有一刀切的完善做法。

---
## 智破通破产案件管理系统
**介绍**：这个项目是一个基于react搭建的web管理平台。项目目标针对是破产案件中的涉事企业，判决法院提供案件重整，案件清算，债权人网络会议，投资人招募等等一体化在线管理服务。因为平台是依托区块链技术，所以安全可靠，高效协同是他的最大特点。
**技术栈**：该项目的前端主要基于umi框架进行开发，因此主要技术栈是其内置的react，antd，dva，mock，eslint，ahooks，webpack等等。
**负责内容**：这个项目的体系还是比较大的，我所负责的只是几个较小的模块功能。比如日报填写，任务分配，材料收发。
1. `日报功能`包含日报填写，日报浏览等页面。填写方案是采取的一个富文本编辑器，利用了braft-editor这个插件。但是官方文档中只有类组件，没有函数组件的写法。所以我将其封装成了函数组件，并且实现了双向绑定。实现方法是用利用useEffect()钩子函数替代了componentDidMount()的生命周期函数，然后用ref取了组件实例的变量和方法，设置state绑定了的onChange事件。当时遇到的一个坑是在改函数式时按照官方文档给文本value赋初值时发生了无限循环的bug，而最后发现的解决方法恰好就是通过ref去获取富文本实例BraftEditor，再使用加载时调用onChange事件，将初始化的value通过onChange事件加入文本中，这样就解决了无限循环问题，实现绑定。
2. `任务分配`功能主要是由任务表单填写，数据列表页面，处理任务页面构成。不能说是难点吧，在写表单组件的时候让我了解到了一个比较重要react特性，当时遇到的情况就是：点击一条数据查看详情，这个时候show了一个dialog，也同时调了一个详情接口，但是表单已经展示过后没有出现对应表单数据，才知道数据滞后了。因为我当时才开始接触react，接口返回的数据使用useState存储的。所以不明白react对于状态更新的方式不同于vue是异步更新状态的，需要在下次重绘后才能获取新值。后面查找了一些资料发现可以通过useRef存储数据，然后再useFffect中监听数据的变化。当我们想使用当前的数据的时候直接用dataRef.current 获取的就是当前最新的数据。
3. `站内消息推送`，提供了任务状态变化、新通知、结果回复等消息的的实时推送功能。用到了websocket。当然websocket的使用还是比简单
``` javascript
componentDidMount() {
  if(typeof(WebSocket) == "undefined") {
    console.log("您的浏览器不支持WebSocket");
  }else{
    console.log("您的浏览器支持WebSocket");
  }
 
  let websocket  = new WebSocket("ws://10.200.125.165:8080/api/mail/index");
  //打开事件
  websocket.onopen = function () {
   console.log("websocket已打开");
  }
  //发现消息进入
  websocket.onmessage = function (msg) {
   console.log("websocket已连接");
   console.log(msg.data);  // 第一次进去会显示：连接成功
  }
  //关闭事件
  websocket.onclose = function() {
   console.log("websocket已关闭");
  };
  //发生了错误事件
  websocket.onerror = function() {
   console.log("websocket发生了错误");
  }
 }
```
![websocket对象属性](https://img-blog.csdnimg.cn/cdef1c9fb13547c8895af586607e49c5.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5a625pyJ552_5bCR,size_20,color_FFFFFF,t_70,g_se,x_16)


## 小程序和h5的区别 
[小程序 pk H5](https://www.woshipm.com/pd/1315132.html)

## 前端优化24条建议
  1. 减少HTTP请求。一个完整的 HTTP 请求需要经历 DNS 查找，TCP 握手，浏览器发出 HTTP 请求，服务器接收请求，服务器处理请求并发回响应，浏览器接收响应等过程。，真正下载数据的时间占比其实不高，建议将多个小文件合并为一个大文件，从而减少 HTTP 请求次数。
  2. 使用HTTP2。相较于HTTP1.1，HTTP具有解析速度更快，多路复用，首部压缩，紧急请求优先级高，流量控制，服务器推送等有点。
  3. 使用服务端渲染。
  4. 使用内容分发网络CDN。
  5. 将CSS放在文件头部，JS文件放在底部。CSS 执行会阻塞渲染，阻止 JS 执行。JS 加载和执行会阻塞 HTML 解析，阻止 CSSOM 构建。
  6. 使用字体图标 iconfont 代替图片图标。
  7. 善用缓存，不重复加载相同的资源。
  8. 压缩文件（webpack，gzip）
  9. 图片优化（延迟加载，响应式图片，降低图片质量利用CCS效果替代，使用webp图片）
  10. 通过 webpack 按需加载代码，提取第三库代码，减少 ES6 转为 ES5 的冗余代码
  11. 减少重绘重排
  12. 使用事件委托
  13. 注意程序的局部性
  14. if-else 对比 switch，当判断条件数量越来越多时，越倾向于使用 switch 而不是 if-else。
  15.  查找表。当条件语句特别多时，使用 switch 和 if-else 不是最佳的选择，这时不妨试一下查找表。查找表可以使用数组和对象来构建。
  16. 避免页面卡顿
  17. 使用 requestAnimationFrame 来实现视觉变化
  18. 使用 Web Workers
  19. 使用位操作
  20. 不要覆盖原生方法
  21. 降低 CSS 选择器的复杂性
  22. 使用 flexbox 而不是较早的布局模型
  23. 使用 transform 和 opacity 属性更改来实现动画
  24. 合理使用规则，避免过度优化。性能优化主要分为两类：加载时优化，运行时优化上述 23 条建议中，属于加载时优化的是前面 10 条建议，属于运行时优化的是后面 13 条建议。通常来说，没有必要 23 条性能优化规则都用上，根据网站用户群体来做针对性的调整是最好的，节省精力，节省时间。
[前端优化24条](https://segmentfault.com/a/1190000022205291)

3. 前端优化35条军规
![雅虎35条军规](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/8/15/1653cde6a580cb29~tplv-t2oaga2asx-zoom-in-crop-mark:3024:0:0:0.awebp)
[雅虎35条军规](https://juejin.cn/post/6844903657318645767)
